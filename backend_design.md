# ë…¸ë¸”ìŠ¤í† ë¦¬ì§€ ë¦¬ë·° ì•± ë°±ì—”ë“œ API ì„¤ê³„ ë¬¸ì„œ

## ê°œìš”
ë…¸ë¸”ìŠ¤í† ë¦¬ì§€ ì´ì‚¬&ë³´ê´€í›„ê¸° ì•±ì„ ìœ„í•œ ë°±ì—”ë“œ API ì„¤ê³„ ë¬¸ì„œì…ë‹ˆë‹¤. SQLite ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ì ì¸ì¦, ë¦¬ë·° ê´€ë¦¬, ì´ë¯¸ì§€ ê´€ë¦¬ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

## ì•± êµ¬ì¡° ë° ê¸°ëŠ¥ ê°œìš”

### ğŸ  **ë©”ì¸ í˜ì´ì§€ (Home)**
- **íšŒì‚¬ ì†Œê°œ** ë° **ì„œë¹„ìŠ¤ ì•ˆë‚´**
- **ìˆ˜ë„ê¶Œ ì „ì—­ 30ë¶„ ê±°ë¦¬ ë¬¼ë¥˜ë§** ì„¹ì…˜
  - 10ê°œ ì„¼í„° ìœ„ì¹˜ í‘œì‹œ (ë¶„ë‹¹1, ë¶„ë‹¹2, ë¶„ë‹¹3, ì„±ë‚¨, ì§ë™, í™”ì„±, ì¸ì²œ, ì¼ì‚°, ëª©ë™, ëª©ë™2)
  - ê° ì„¼í„°ë³„ **ì¹´ì¹´ì˜¤ë§µ ë§í¬** ì—°ê²°
  - 4ì—´ ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ (ë§ˆì§€ë§‰ 2ê°œëŠ” ê°ê° 1/2 ë„ˆë¹„)
- **ê³ ê° í›„ê¸°** ì„¹ì…˜
  - ëŒ€í‘œ í›„ê¸° ì´ë¯¸ì§€ í‘œì‹œ
  - **ì´ì‚¬&ë³´ê´€í›„ê¸°** í˜ì´ì§€ë¡œ ì—°ê²°

### ğŸ“‹ **ë¦¬ë·° ëª©ë¡ í˜ì´ì§€ (/reviews)**
- **3ì—´ 5í–‰ ê·¸ë¦¬ë“œ** ë ˆì´ì•„ì›ƒ
- **í˜ì´ì§€ë„¤ì´ì…˜** (6ê°œì”© í‘œì‹œ)
- **ë”ë¯¸ ë°ì´í„°** 50ê°œ ìƒì„±
- ê° ë¦¬ë·° ì¹´ë“œ í´ë¦­ ì‹œ **ìƒì„¸ í˜ì´ì§€**ë¡œ ì´ë™
- **"Showing X to Y of Z entries"** ì •ë³´ í‘œì‹œ

### ğŸ“– **ë¦¬ë·° ìƒì„¸ í˜ì´ì§€ (/reviews/:id)**
- **ì œëª©, ì‘ì„±ì, ì‘ì„±ì¼** í‘œì‹œ
- **ì´ì‚¬ ê²½ë¡œ** (ì¶œë°œì§€ â†’ ë„ì°©ì§€, ë‚ ì§œ)
- **í‰ì ** (ë³„ì  í‘œì‹œ)
- **í›„ê¸° ë‚´ìš©** (ì „ì²´ í…ìŠ¤íŠ¸)
- **ì´ë¯¸ì§€ ê°¤ëŸ¬ë¦¬** (2-3ê°œ ì´ë¯¸ì§€)
  - í´ë¦­ ì‹œ **í’€ìŠ¤í¬ë¦° ëª¨ë‹¬** í‘œì‹œ
- **ê´€ë¦¬ì ì „ìš© ê¸°ëŠ¥**:
  - **ìˆ˜ì • ë²„íŠ¼** (íŒŒë€ìƒ‰)
  - **ì‚­ì œ ë²„íŠ¼** (ë¹¨ê°„ìƒ‰)
  - ê´€ë¦¬ì ë¡œê·¸ì¸ ì‹œì—ë§Œ í‘œì‹œ

### âœï¸ **ë¦¬ë·° ìˆ˜ì • í˜ì´ì§€ (/reviews/:id/edit)**
- **ê¸°ì¡´ ë°ì´í„°** ìë™ ë¡œë“œ
- **í¼ í•„ë“œ**:
  - íŒ€ëª…, ì œëª©, ì‘ì„±ìëª…
  - ì¶œë°œì§€, ë„ì°©ì§€, ì¶œë°œì¼, ë„ì°©ì¼
  - í‰ì  (1-5ì )
  - í›„ê¸° ë‚´ìš©
- **ì´ë¯¸ì§€ ê´€ë¦¬**:
  - **ê¸°ì¡´ ì´ë¯¸ì§€** í‘œì‹œ (ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ)
  - **ìƒˆ ì´ë¯¸ì§€ ì—…ë¡œë“œ** (ìµœëŒ€ 3ê°œ)
  - **ë¡œì»¬ íŒŒì¼** ì—…ë¡œë“œ ì§€ì›
- **ê´€ë¦¬ì ì¸ì¦** í•„ìˆ˜

### â• **ìƒˆ ë¦¬ë·° ì‘ì„± í˜ì´ì§€ (/admin)**
- **ê´€ë¦¬ì ì „ìš©** ì ‘ê·¼
- **í¼ í•„ë“œ** (ìˆ˜ì • í˜ì´ì§€ì™€ ë™ì¼)
- **ì´ë¯¸ì§€ ì—…ë¡œë“œ**:
  - **ë“œë˜ê·¸ ì•¤ ë“œë¡­** ìŠ¤íƒ€ì¼
  - **íŒŒì¼ëª… í‘œì‹œ**
  - **ë¯¸ë¦¬ë³´ê¸°** ê¸°ëŠ¥
  - **ì´ë¯¸ì§€ íŒŒì¼ë§Œ** í—ˆìš©
- **ë“±ë¡/ì·¨ì†Œ** ë²„íŠ¼

### ğŸ” **ê´€ë¦¬ì ë¡œê·¸ì¸ í˜ì´ì§€ (/login)**
- **ID/Password** ì…ë ¥ í¼
- **í…ŒìŠ¤íŠ¸ ê³„ì •**: `tony` / `test0723`
- **ì—ëŸ¬ ë©”ì‹œì§€** í‘œì‹œ
- **ì„¸ì…˜ ê¸°ë°˜** ì¸ì¦
- **ë¡œê·¸ì¸ ì„±ê³µ ì‹œ** `/admin`ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

### ğŸ§­ **ë„¤ë¹„ê²Œì´ì…˜ (Header)**
- **ë¡œê³ ** ë° **ë©”ë‰´**
- **ì´ì‚¬&ë³´ê´€í›„ê¸°** ë§í¬ â†’ `/reviews`
- **ë°˜ì‘í˜•** ëª¨ë°”ì¼ ë©”ë‰´

## ì‚¬ìš©ì í”Œë¡œìš°

### ğŸ‘¤ **ì¼ë°˜ ì‚¬ìš©ì í”Œë¡œìš°**
1. **ë©”ì¸ í˜ì´ì§€** ì ‘ì†
2. **ë¬¼ë¥˜ë§ ì„¹ì…˜**ì—ì„œ ì„¼í„° ìœ„ì¹˜ í™•ì¸
3. **ì´ì‚¬&ë³´ê´€í›„ê¸°** í´ë¦­ â†’ ë¦¬ë·° ëª©ë¡
4. **ë¦¬ë·° ì¹´ë“œ** í´ë¦­ â†’ ìƒì„¸ í˜ì´ì§€
5. **ì´ë¯¸ì§€ í´ë¦­** â†’ í’€ìŠ¤í¬ë¦° ëª¨ë‹¬
6. **ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°** â†’ ë¦¬ë·° ëª©ë¡

### ğŸ‘¨â€ğŸ’¼ **ê´€ë¦¬ì í”Œë¡œìš°**
1. **ë¡œê·¸ì¸ í˜ì´ì§€** (`/login`)
2. **ì¸ì¦** (`tony` / `test0723`)
3. **ìƒˆ ë¦¬ë·° ì‘ì„±** (`/admin`) ë˜ëŠ” **ê¸°ì¡´ ë¦¬ë·° ìˆ˜ì •** (`/reviews/:id/edit`)
4. **ì´ë¯¸ì§€ ì—…ë¡œë“œ** ë° **í¼ ì‘ì„±**
5. **ì €ì¥** â†’ ë¦¬ë·° ëª©ë¡ ë˜ëŠ” ìƒì„¸ í˜ì´ì§€
6. **ë¦¬ë·° ì‚­ì œ** (ìƒì„¸ í˜ì´ì§€ì—ì„œ)

## ë°ì´í„° êµ¬ì¡°

### ğŸ“Š **ë¦¬ë·° ë°ì´í„° ëª¨ë¸**
```javascript
{
  id: 1,
  team: "27íŒ€",
  title: "27íŒ€ 1ì°¨ í›„ê¸°ì…ë‹ˆë‹¤~",
  userName: "ë°•**ë‹˜",
  date: "2ì¼ì „",
  fromLocation: "ê²½ê¸° êµ°í¬ì‹œ",
  toLocation: "ì„œìš¸ ë…¸ì›êµ¬",
  fromDate: "10.19",
  toDate: "11.02",
  rating: 5,
  image: "https://picsum.photos/800/600?random=1",
  images: [
    "https://picsum.photos/800/600?random=1",
    "https://picsum.photos/800/600?random=101",
    "https://picsum.photos/800/600?random=201"
  ],
  content: "27íŒ€ì´ ì •ë§ ì¹œì ˆí•˜ê²Œ ë„ì™€ì£¼ì…¨ì–´ìš”..."
}
```

### ğŸ¢ **ì„¼í„° ë°ì´í„°**
```javascript
{
  name: "ë¶„ë‹¹ 1ì„¼í„°",
  address: "ê²½ê¸°ë„ ê´‘ì£¼ì‹œ ì˜¤í¬ì ì‹ í˜„ë¦¬ 412-12",
  kakaoMapUrl: "https://map.kakao.com/?urlX=536095...",
  image: "/bundang1.png"
}
```

## ê¸°ìˆ ì  íŠ¹ì§•

### ğŸ¨ **UI/UX íŠ¹ì§•**
- **ë°˜ì‘í˜• ë””ìì¸** (ë°ìŠ¤í¬í†±/íƒœë¸”ë¦¿/ëª¨ë°”ì¼)
- **CSS Grid** ë ˆì´ì•„ì›ƒ
- **ëª¨ë˜í•œ ë””ìì¸** (ê·¸ë¦¼ì, ë‘¥ê·¼ ëª¨ì„œë¦¬)
- **í˜¸ë²„ íš¨ê³¼** ë° **íŠ¸ëœì§€ì…˜**
- **ì¼ê´€ëœ ìƒ‰ìƒ** í…Œë§ˆ

### ğŸ”’ **ë³´ì•ˆ ê¸°ëŠ¥**
- **ì„¸ì…˜ ê¸°ë°˜** ì¸ì¦
- **ê´€ë¦¬ì ê¶Œí•œ** ê²€ì¦
- **ì§ì ‘ URL ì ‘ê·¼** ì°¨ë‹¨
- **íŒŒì¼ íƒ€ì…** ê²€ì¦

### ğŸ“± **ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ**
- **ë°ìŠ¤í¬í†±**: 4ì—´ (ì„¼í„°), 3ì—´ (ë¦¬ë·°)
- **íƒœë¸”ë¦¿**: 3ì—´ (ì„¼í„°), 2ì—´ (ë¦¬ë·°)
- **ëª¨ë°”ì¼**: 1ì—´ (ëª¨ë“  ê·¸ë¦¬ë“œ)

### ğŸ–¼ï¸ **ì´ë¯¸ì§€ ì²˜ë¦¬**
- **ë¡œì»¬ íŒŒì¼** ì—…ë¡œë“œ
- **ë¯¸ë¦¬ë³´ê¸°** ê¸°ëŠ¥
- **ë‹¤ì¤‘ ì´ë¯¸ì§€** ì§€ì›
- **í’€ìŠ¤í¬ë¦° ëª¨ë‹¬**
- **ë°˜ì‘í˜•** ì´ë¯¸ì§€ í¬ê¸°

## API ì—°ë™ ê³„íš

### ğŸ”„ **í”„ë¡ íŠ¸ì—”ë“œ-ë°±ì—”ë“œ ì—°ë™**
- **ë”ë¯¸ ë°ì´í„°** â†’ **ì‹¤ì œ API** í˜¸ì¶œ
- **ì„¸ì…˜ ì¸ì¦** â†’ **JWT í† í°** ì¸ì¦
- **ë¡œì»¬ íŒŒì¼** â†’ **ì„œë²„ ì—…ë¡œë“œ**
- **í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ** â†’ **ì„œë²„ ìƒíƒœ** ë™ê¸°í™”

### ğŸ“¡ **API ì—”ë“œí¬ì¸íŠ¸ ë§¤í•‘**
- **ë¦¬ë·° ëª©ë¡**: `GET /api/reviews`
- **ë¦¬ë·° ìƒì„¸**: `GET /api/reviews/:id`
- **ë¦¬ë·° ìƒì„±**: `POST /api/reviews`
- **ë¦¬ë·° ìˆ˜ì •**: `PUT /api/reviews/:id`
- **ë¦¬ë·° ì‚­ì œ**: `DELETE /api/reviews/:id`
- **ì´ë¯¸ì§€ ì—…ë¡œë“œ**: `POST /api/images/upload`
- **ê´€ë¦¬ì ë¡œê·¸ì¸**: `POST /api/auth/login`

### ğŸ” **ì¸ì¦ ì‹œìŠ¤í…œ**
- **í˜„ì¬**: `sessionStorage` ê¸°ë°˜
- **ê³„íš**: JWT í† í° ê¸°ë°˜
- **í† í° ë§Œë£Œ**: 24ì‹œê°„
- **ìë™ ê°±ì‹ **: ë¦¬í”„ë ˆì‹œ í† í°

## í™•ì¥ ê³„íš

### ğŸš€ **í–¥í›„ ê¸°ëŠ¥**
- **ê²€ìƒ‰ ê¸°ëŠ¥** (ì œëª©, ë‚´ìš©, íŒ€ëª…)
- **í•„í„°ë§** (í‰ì , ë‚ ì§œ, ì§€ì—­)
- **ì •ë ¬** (ìµœì‹ ìˆœ, í‰ì ìˆœ)
- **ëŒ“ê¸€ ì‹œìŠ¤í…œ**
- **ì¢‹ì•„ìš”/ì‹«ì–´ìš”**
- **í†µê³„ ëŒ€ì‹œë³´ë“œ**

### ğŸ“Š **ê´€ë¦¬ì ê¸°ëŠ¥ í™•ì¥**
- **ë¦¬ë·° ìŠ¹ì¸/ê±°ë¶€**
- **ì‚¬ìš©ì ê´€ë¦¬**
- **í†µê³„ ë¶„ì„**
- **ì´ë¯¸ì§€ ê´€ë¦¬**
- **ë°±ì—…/ë³µì›**

### ğŸ”§ **ê¸°ìˆ ì  ê°œì„ **
- **ìƒíƒœ ê´€ë¦¬** (Redux/Zustand)
- **ìºì‹±** (React Query)
- **PWA** ì§€ì›
- **SEO** ìµœì í™”
- **ì„±ëŠ¥ ìµœì í™”**

## ê¸°ìˆ  ìŠ¤íƒ
- **ë°ì´í„°ë² ì´ìŠ¤**: SQLite
- **API í”„ë ˆì„ì›Œí¬**: FastAPI (Python)
- **ORM**: SQLAlchemy
- **ì¸ì¦**: JWT (JSON Web Token)
- **íŒŒì¼ ì—…ë¡œë“œ**: FastAPI UploadFile
- **ì´ë¯¸ì§€ ì²˜ë¦¬**: Pillow (PIL)
- **ë¹„ë°€ë²ˆí˜¸ í•´ì‹±**: Passlib + Bcrypt
- **ë°ì´í„° ê²€ì¦**: Pydantic

## ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### 1. ì‚¬ìš©ì í…Œì´ë¸” (users)
```sql
CREATE TABLE users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT NOT NULL UNIQUE,
    password_hash TEXT NOT NULL,
    email TEXT,
    role TEXT DEFAULT 'user' CHECK (role IN ('user', 'admin')),
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

### 2. ë¦¬ë·° í…Œì´ë¸” (reviews)
```sql
CREATE TABLE reviews (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    team TEXT NOT NULL,
    title TEXT NOT NULL,
    content TEXT NOT NULL,
    from_location TEXT NOT NULL,
    to_location TEXT NOT NULL,
    from_date TEXT NOT NULL,
    to_date TEXT NOT NULL,
    rating INTEGER NOT NULL CHECK (rating >= 1 AND rating <= 5),
    status TEXT DEFAULT 'published' CHECK (status IN ('draft', 'published', 'deleted')),
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);
```

### 3. ë¦¬ë·° ì´ë¯¸ì§€ í…Œì´ë¸” (review_images)
```sql
CREATE TABLE review_images (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    review_id INTEGER NOT NULL,
    image_url TEXT NOT NULL,
    image_filename TEXT NOT NULL,
    image_size INTEGER,
    image_mime_type TEXT,
    sort_order INTEGER DEFAULT 0,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (review_id) REFERENCES reviews(id) ON DELETE CASCADE
);
```

### 4. ê´€ë¦¬ì ì„¸ì…˜ í…Œì´ë¸” (admin_sessions)
```sql
CREATE TABLE admin_sessions (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    session_token TEXT NOT NULL UNIQUE,
    user_id INTEGER NOT NULL,
    expires_at DATETIME NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);
```

## ì¸ë±ìŠ¤ ìƒì„±
```sql
-- ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•œ ì¸ë±ìŠ¤
CREATE INDEX idx_reviews_user_id ON reviews(user_id);
CREATE INDEX idx_reviews_created_at ON reviews(created_at);
CREATE INDEX idx_reviews_status ON reviews(status);
CREATE INDEX idx_review_images_review_id ON review_images(review_id);
CREATE INDEX idx_admin_sessions_token ON admin_sessions(session_token);
CREATE INDEX idx_admin_sessions_expires ON admin_sessions(expires_at);
```

## API ì—”ë“œí¬ì¸íŠ¸ ì„¤ê³„

### 1. ì¸ì¦ ê´€ë ¨ API

#### POST /api/auth/login
ê´€ë¦¬ì ë¡œê·¸ì¸
```json
// Request
{
  "username": "tony",
  "password": "test0723"
}

// Response
{
  "success": true,
  "message": "ë¡œê·¸ì¸ ì„±ê³µ",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 1,
      "username": "tony",
      "role": "admin"
    }
  }
}
```

#### POST /api/auth/logout
ë¡œê·¸ì•„ì›ƒ
```json
// Request Headers
{
  "Authorization": "Bearer <token>"
}

// Response
{
  "success": true,
  "message": "ë¡œê·¸ì•„ì›ƒ ì„±ê³µ"
}
```

#### GET /api/auth/verify
í† í° ê²€ì¦
```json
// Request Headers
{
  "Authorization": "Bearer <token>"
}

// Response
{
  "success": true,
  "data": {
    "user": {
      "id": 1,
      "username": "tony",
      "role": "admin"
    }
  }
}
```

### 2. ë¦¬ë·° ê´€ë¦¬ API

#### GET /api/reviews
ë¦¬ë·° ëª©ë¡ ì¡°íšŒ (í˜ì´ì§€ë„¤ì´ì…˜)
```json
// Query Parameters
?page=1&limit=6&status=published

// Response
{
  "success": true,
  "data": {
    "reviews": [
      {
        "id": 1,
        "team": "27íŒ€",
        "title": "27íŒ€ 1ì°¨ í›„ê¸°ì…ë‹ˆë‹¤~",
        "userName": "ë°•**ë‹˜",
        "date": "2ì¼ì „",
        "fromLocation": "ê²½ê¸° êµ°í¬ì‹œ",
        "toLocation": "ì„œìš¸ ë…¸ì›êµ¬",
        "fromDate": "10.19",
        "toDate": "11.02",
        "rating": 5,
        "image": "https://api.example.com/images/review_1_main.jpg",
        "images": [
          "https://api.example.com/images/review_1_1.jpg",
          "https://api.example.com/images/review_1_2.jpg",
          "https://api.example.com/images/review_1_3.jpg"
        ],
        "content": "27íŒ€ì´ ì •ë§ ì¹œì ˆí•˜ê²Œ ë„ì™€ì£¼ì…¨ì–´ìš”...",
        "created_at": "2025-01-15T10:30:00Z"
      }
    ],
    "pagination": {
      "current_page": 1,
      "total_pages": 9,
      "total_items": 50,
      "items_per_page": 6
    }
  }
}
```

#### GET /api/reviews/:id
íŠ¹ì • ë¦¬ë·° ìƒì„¸ ì¡°íšŒ
```json
// Response
{
  "success": true,
  "data": {
    "id": 1,
    "team": "27íŒ€",
    "title": "27íŒ€ 1ì°¨ í›„ê¸°ì…ë‹ˆë‹¤~",
    "userName": "ë°•**ë‹˜",
    "date": "2ì¼ì „",
    "fromLocation": "ê²½ê¸° êµ°í¬ì‹œ",
    "toLocation": "ì„œìš¸ ë…¸ì›êµ¬",
    "fromDate": "10.19",
    "toDate": "11.02",
    "rating": 5,
    "images": [
      {
        "id": 1,
        "image_url": "https://api.example.com/images/review_1_1.jpg",
        "sort_order": 0
      },
      {
        "id": 2,
        "image_url": "https://api.example.com/images/review_1_2.jpg",
        "sort_order": 1
      }
    ],
    "content": "27íŒ€ì´ ì •ë§ ì¹œì ˆí•˜ê²Œ ë„ì™€ì£¼ì…¨ì–´ìš”...",
    "created_at": "2025-01-15T10:30:00Z"
  }
}
```

#### POST /api/reviews
ìƒˆ ë¦¬ë·° ìƒì„± (ê´€ë¦¬ì ì „ìš©)
```json
// Request (multipart/form-data)
{
  "team": "27íŒ€",
  "title": "ìƒˆë¡œìš´ í›„ê¸°",
  "userName": "ê¹€**ë‹˜",
  "fromLocation": "ì„œìš¸ ê°•ë‚¨êµ¬",
  "toLocation": "ì„œìš¸ ì„œì´ˆêµ¬",
  "fromDate": "01.15",
  "toDate": "01.20",
  "rating": 5,
  "content": "ì •ë§ ë§Œì¡±ìŠ¤ëŸ¬ìš´ ì„œë¹„ìŠ¤ì˜€ìŠµë‹ˆë‹¤.",
  "images": [File, File, File] // ìµœëŒ€ 3ê°œ ì´ë¯¸ì§€
}

// Response
{
  "success": true,
  "message": "ë¦¬ë·°ê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.",
  "data": {
    "review_id": 51
  }
}
```

#### PUT /api/reviews/:id
ë¦¬ë·° ìˆ˜ì • (ê´€ë¦¬ì ì „ìš©)
```json
// Request (multipart/form-data)
{
  "team": "27íŒ€",
  "title": "ìˆ˜ì •ëœ í›„ê¸° ì œëª©",
  "userName": "ê¹€**ë‹˜",
  "fromLocation": "ì„œìš¸ ê°•ë‚¨êµ¬",
  "toLocation": "ì„œìš¸ ì„œì´ˆêµ¬",
  "fromDate": "01.15",
  "toDate": "01.20",
  "rating": 5,
  "content": "ìˆ˜ì •ëœ í›„ê¸° ë‚´ìš©ì…ë‹ˆë‹¤.",
  "images": [File, File, File], // ìµœëŒ€ 3ê°œ ì´ë¯¸ì§€
  "remove_existing_images": [1, 2] // ê¸°ì¡´ ì´ë¯¸ì§€ ID ë°°ì—´ (ì„ íƒì‚¬í•­)
}

// Response
{
  "success": true,
  "message": "ë¦¬ë·°ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.",
  "data": {
    "review_id": 1,
    "updated_at": "2025-01-15T15:30:00Z"
  }
}
```

#### DELETE /api/reviews/:id
ë¦¬ë·° ì‚­ì œ (ê´€ë¦¬ì ì „ìš©)
```json
// Request Headers
{
  "Authorization": "Bearer <token>"
}

// Response
{
  "success": true,
  "message": "ë¦¬ë·°ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."
}
```

### 3. ì´ë¯¸ì§€ ê´€ë¦¬ API

#### POST /api/images/upload
ì´ë¯¸ì§€ ì—…ë¡œë“œ
```json
// Request (multipart/form-data)
{
  "image": File
}

// Response
{
  "success": true,
  "data": {
    "image_url": "https://api.example.com/images/uploaded_123456.jpg",
    "filename": "review_image_123456.jpg",
    "size": 1024000,
    "mime_type": "image/jpeg"
  }
}
```

#### DELETE /api/images/:filename
ì´ë¯¸ì§€ ì‚­ì œ
```json
// Response
{
  "success": true,
  "message": "ì´ë¯¸ì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."
}
```

#### PUT /api/reviews/:id/images
ë¦¬ë·° ì´ë¯¸ì§€ ìˆ˜ì • (ê´€ë¦¬ì ì „ìš©)
```json
// Request (multipart/form-data)
{
  "images": [File, File, File], // ìƒˆë¡œ ì¶”ê°€í•  ì´ë¯¸ì§€ë“¤
  "remove_images": [1, 2, 3] // ì‚­ì œí•  ê¸°ì¡´ ì´ë¯¸ì§€ IDë“¤
}

// Response
{
  "success": true,
  "message": "ë¦¬ë·° ì´ë¯¸ì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.",
  "data": {
    "added_images": [
      {
        "id": 4,
        "image_url": "https://api.example.com/images/review_1_4.jpg",
        "sort_order": 0
      }
    ],
    "removed_images": [1, 2, 3]
  }
}
```

## ì—ëŸ¬ ì‘ë‹µ í˜•ì‹
```json
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "ì…ë ¥ ë°ì´í„°ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.",
    "details": {
      "title": "ì œëª©ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.",
      "rating": "í‰ì ì€ 1-5 ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤."
    }
  }
}
```

## HTTP ìƒíƒœ ì½”ë“œ
- **200**: ì„±ê³µ
- **201**: ìƒì„± ì„±ê³µ
- **400**: ì˜ëª»ëœ ìš”ì²­
- **401**: ì¸ì¦ ì‹¤íŒ¨
- **403**: ê¶Œí•œ ì—†ìŒ
- **404**: ë¦¬ì†ŒìŠ¤ ì—†ìŒ
- **422**: ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨
- **500**: ì„œë²„ ì˜¤ë¥˜

## ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### 1. ì¸ì¦ ë° ê¶Œí•œ
- JWT í† í° ê¸°ë°˜ ì¸ì¦
- ê´€ë¦¬ì ê¶Œí•œ ê²€ì¦
- í† í° ë§Œë£Œ ì‹œê°„ ì„¤ì • (24ì‹œê°„)

### 2. íŒŒì¼ ì—…ë¡œë“œ ë³´ì•ˆ
- íŒŒì¼ íƒ€ì… ê²€ì¦ (ì´ë¯¸ì§€ë§Œ í—ˆìš©)
- íŒŒì¼ í¬ê¸° ì œí•œ (5MB)
- íŒŒì¼ëª… ì¤‘ë³µ ë°©ì§€
- ì•…ì„± íŒŒì¼ ìŠ¤ìº”

### 3. ë°ì´í„° ê²€ì¦
- ì…ë ¥ ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬
- SQL ì¸ì ì…˜ ë°©ì§€
- XSS ê³µê²© ë°©ì§€

## í™˜ê²½ ì„¤ì •

### í™˜ê²½ ë³€ìˆ˜ (.env)
```env
# ë°ì´í„°ë² ì´ìŠ¤
DATABASE_URL=sqlite:///./database/reviews.db

# JWT ì„¤ì •
SECRET_KEY=your-secret-key-here
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=1440

# íŒŒì¼ ì—…ë¡œë“œ
UPLOAD_DIR=./uploads
MAX_FILE_SIZE=5242880
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,image/webp

# ì„œë²„ ì„¤ì •
HOST=0.0.0.0
PORT=8000
DEBUG=True
```

### Python ì˜ì¡´ì„± (requirements.txt)
```txt
fastapi==0.104.1
uvicorn[standard]==0.24.0
sqlalchemy==2.0.23
alembic==1.12.1
python-jose[cryptography]==3.3.0
passlib[bcrypt]==1.7.4
python-multipart==0.0.6
pillow==10.1.0
python-dotenv==1.0.0
pydantic==2.5.0
pydantic-settings==2.1.0
```

### í”„ë¡œì íŠ¸ êµ¬ì¡°
```
backend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py
â”‚   â”œâ”€â”€ config.py
â”‚   â”œâ”€â”€ database.py
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ user.py
â”‚   â”‚   â”œâ”€â”€ review.py
â”‚   â”‚   â””â”€â”€ image.py
â”‚   â”œâ”€â”€ schemas/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ user.py
â”‚   â”‚   â”œâ”€â”€ review.py
â”‚   â”‚   â””â”€â”€ auth.py
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ auth.py
â”‚   â”‚   â”œâ”€â”€ reviews.py
â”‚   â”‚   â””â”€â”€ images.py
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ security.py
â”‚   â”‚   â””â”€â”€ config.py
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ file_handler.py
â”œâ”€â”€ uploads/
â”œâ”€â”€ database/
â”‚   â””â”€â”€ reviews.db
â”œâ”€â”€ alembic/
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ .env
â””â”€â”€ README.md
```

## ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸

### init_database.sql
```sql
-- ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸

-- í…Œì´ë¸” ìƒì„±
CREATE TABLE IF NOT EXISTS users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT NOT NULL UNIQUE,
    password_hash TEXT NOT NULL,
    email TEXT,
    role TEXT DEFAULT 'user' CHECK (role IN ('user', 'admin')),
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS reviews (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    team TEXT NOT NULL,
    title TEXT NOT NULL,
    content TEXT NOT NULL,
    from_location TEXT NOT NULL,
    to_location TEXT NOT NULL,
    from_date TEXT NOT NULL,
    to_date TEXT NOT NULL,
    rating INTEGER NOT NULL CHECK (rating >= 1 AND rating <= 5),
    status TEXT DEFAULT 'published' CHECK (status IN ('draft', 'published', 'deleted')),
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS review_images (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    review_id INTEGER NOT NULL,
    image_url TEXT NOT NULL,
    image_filename TEXT NOT NULL,
    image_size INTEGER,
    image_mime_type TEXT,
    sort_order INTEGER DEFAULT 0,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (review_id) REFERENCES reviews(id) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS admin_sessions (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    session_token TEXT NOT NULL UNIQUE,
    user_id INTEGER NOT NULL,
    expires_at DATETIME NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

-- ì¸ë±ìŠ¤ ìƒì„±
CREATE INDEX IF NOT EXISTS idx_reviews_user_id ON reviews(user_id);
CREATE INDEX IF NOT EXISTS idx_reviews_created_at ON reviews(created_at);
CREATE INDEX IF NOT EXISTS idx_reviews_status ON reviews(status);
CREATE INDEX IF NOT EXISTS idx_review_images_review_id ON review_images(review_id);
CREATE INDEX IF NOT EXISTS idx_admin_sessions_token ON admin_sessions(session_token);
CREATE INDEX IF NOT EXISTS idx_admin_sessions_expires ON admin_sessions(expires_at);

-- ê¸°ë³¸ ê´€ë¦¬ì ê³„ì • ìƒì„±
INSERT OR IGNORE INTO users (username, password_hash, role) 
VALUES ('tony', '$2b$10$example_hash_here', 'admin');

-- ë”ë¯¸ ë°ì´í„° ì‚½ì… (ê°œë°œìš©)
INSERT OR IGNORE INTO reviews (user_id, team, title, content, from_location, to_location, from_date, to_date, rating, status)
SELECT 
    1,
    '27íŒ€',
    '27íŒ€ 1ì°¨ í›„ê¸°ì…ë‹ˆë‹¤~',
    '27íŒ€ì´ ì •ë§ ì¹œì ˆí•˜ê²Œ ë„ì™€ì£¼ì…¨ì–´ìš”. ì´ì‚¬ê°€ ìƒê°ë³´ë‹¤ í¸í–ˆì–´ìš”.',
    'ê²½ê¸° êµ°í¬ì‹œ',
    'ì„œìš¸ ë…¸ì›êµ¬',
    '10.19',
    '11.02',
    5,
    'published'
WHERE NOT EXISTS (SELECT 1 FROM reviews WHERE id = 1);
```

## API í…ŒìŠ¤íŠ¸ ì˜ˆì‹œ

### cURL ëª…ë ¹ì–´ ì˜ˆì‹œ
```bash
# ê´€ë¦¬ì ë¡œê·¸ì¸
curl -X POST http://localhost:8000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username": "tony", "password": "test0723"}'

# ë¦¬ë·° ëª©ë¡ ì¡°íšŒ
curl -X GET "http://localhost:8000/api/reviews?page=1&limit=6"

# íŠ¹ì • ë¦¬ë·° ì¡°íšŒ
curl -X GET http://localhost:8000/api/reviews/1

# ë¦¬ë·° ìˆ˜ì • (ê´€ë¦¬ì ì „ìš©)
curl -X PUT http://localhost:8000/api/reviews/1 \
  -H "Authorization: Bearer <token>" \
  -F "team=27íŒ€" \
  -F "title=ìˆ˜ì •ëœ í›„ê¸°" \
  -F "userName=ê¹€**ë‹˜" \
  -F "fromLocation=ì„œìš¸ ê°•ë‚¨êµ¬" \
  -F "toLocation=ì„œìš¸ ì„œì´ˆêµ¬" \
  -F "fromDate=01.15" \
  -F "toDate=01.20" \
  -F "rating=5" \
  -F "content=ìˆ˜ì •ëœ í›„ê¸° ë‚´ìš©" \
  -F "images=@image1.jpg" \
  -F "images=@image2.jpg"

# ë¦¬ë·° ì‚­ì œ (ê´€ë¦¬ì ì „ìš©)
curl -X DELETE http://localhost:8000/api/reviews/1 \
  -H "Authorization: Bearer <token>"
```

### Python í´ë¼ì´ì–¸íŠ¸ ì˜ˆì‹œ
```python
import requests
import json

# ê¸°ë³¸ ì„¤ì •
BASE_URL = "http://localhost:8000"
headers = {"Content-Type": "application/json"}

# ê´€ë¦¬ì ë¡œê·¸ì¸
def login():
    response = requests.post(
        f"{BASE_URL}/api/auth/login",
        json={"username": "tony", "password": "test0723"}
    )
    if response.status_code == 200:
        token = response.json()["data"]["token"]
        headers["Authorization"] = f"Bearer {token}"
        return token
    return None

# ë¦¬ë·° ëª©ë¡ ì¡°íšŒ
def get_reviews(page=1, limit=6):
    response = requests.get(
        f"{BASE_URL}/api/reviews",
        params={"page": page, "limit": limit}
    )
    return response.json()

# íŠ¹ì • ë¦¬ë·° ì¡°íšŒ
def get_review(review_id):
    response = requests.get(f"{BASE_URL}/api/reviews/{review_id}")
    return response.json()

# ë¦¬ë·° ìˆ˜ì •
def update_review(review_id, data, files=None):
    response = requests.put(
        f"{BASE_URL}/api/reviews/{review_id}",
        data=data,
        files=files,
        headers={"Authorization": headers.get("Authorization")}
    )
    return response.json()

# ë¦¬ë·° ì‚­ì œ
def delete_review(review_id):
    response = requests.delete(
        f"{BASE_URL}/api/reviews/{review_id}",
        headers=headers
    )
    return response.json()

# ì‚¬ìš© ì˜ˆì‹œ
if __name__ == "__main__":
    # ë¡œê·¸ì¸
    token = login()
    if token:
        print("ë¡œê·¸ì¸ ì„±ê³µ!")
        
        # ë¦¬ë·° ëª©ë¡ ì¡°íšŒ
        reviews = get_reviews()
        print(f"ë¦¬ë·° ê°œìˆ˜: {len(reviews['data']['reviews'])}")
        
        # íŠ¹ì • ë¦¬ë·° ì¡°íšŒ
        review = get_review(1)
        print(f"ë¦¬ë·° ì œëª©: {review['data']['title']}")
    else:
        print("ë¡œê·¸ì¸ ì‹¤íŒ¨!")
```

### FastAPI ìë™ ë¬¸ì„œ
FastAPIëŠ” ìë™ìœ¼ë¡œ API ë¬¸ì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤:
- **Swagger UI**: `http://localhost:8000/docs`
- **ReDoc**: `http://localhost:8000/redoc`

## ë°°í¬ ê³ ë ¤ì‚¬í•­

### 1. í”„ë¡œë•ì…˜ ì„¤ì •
- HTTPS ì‚¬ìš©
- í™˜ê²½ ë³€ìˆ˜ ë³´ì•ˆ ê´€ë¦¬
- ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—… ì •ì±…
- ë¡œê·¸ ê´€ë¦¬
- Gunicorn + Uvicorn ì›Œì»¤ ì‚¬ìš©

### 2. ì„±ëŠ¥ ìµœì í™”
- ë°ì´í„°ë² ì´ìŠ¤ ì¸ë±ìŠ¤ ìµœì í™”
- ì´ë¯¸ì§€ ë¦¬ì‚¬ì´ì§• ë° ì••ì¶•
- CDN ì‚¬ìš© ê³ ë ¤
- ìºì‹± ì „ëµ (Redis)
- ë¹„ë™ê¸° ì²˜ë¦¬ ìµœì í™”

### 3. ëª¨ë‹ˆí„°ë§
- API ì‘ë‹µ ì‹œê°„ ëª¨ë‹ˆí„°ë§
- ì—ëŸ¬ ë¡œê·¸ ìˆ˜ì§‘
- ì‚¬ìš©ì í™œë™ ì¶”ì 
- ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§

### 4. Docker ë°°í¬
```dockerfile
# Dockerfile
FROM python:3.11-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

EXPOSE 8000

CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
```

```yaml
# docker-compose.yml
version: '3.8'
services:
  backend:
    build: .
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=sqlite:///./database/reviews.db
      - SECRET_KEY=your-secret-key
    volumes:
      - ./uploads:/app/uploads
      - ./database:/app/database
    restart: unless-stopped
```

### 5. ê°œë°œ í™˜ê²½ ì‹¤í–‰
```bash
# ê°€ìƒí™˜ê²½ ìƒì„±
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# ì˜ì¡´ì„± ì„¤ì¹˜
pip install -r requirements.txt

# ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”
alembic upgrade head

# ì„œë²„ ì‹¤í–‰
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

---

ì´ ì„¤ê³„ ë¬¸ì„œëŠ” ë…¸ë¸”ìŠ¤í† ë¦¬ì§€ ë¦¬ë·° ì•±ì˜ ë°±ì—”ë“œ API êµ¬í˜„ì„ ìœ„í•œ ì™„ì „í•œ ê°€ì´ë“œì…ë‹ˆë‹¤. ì‹¤ì œ êµ¬í˜„ ì‹œì—ëŠ” ë³´ì•ˆ, ì„±ëŠ¥, í™•ì¥ì„±ì„ ê³ ë ¤í•˜ì—¬ ì„¸ë¶€ ì‚¬í•­ì„ ì¡°ì •í•´ì•¼ í•©ë‹ˆë‹¤.
